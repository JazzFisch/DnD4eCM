/// <reference path="knockout-3.0.0.debug.js" />
/// <reference path="underscore.js" />
/// <reference path="statblockhelpers.js" />
/// <reference path="bindinghandlers.js" />

// Duncan McTiernan
var debugJson = '{"Class":"Paladin","ClassFeatures":[{"Name":"Knight Hospitaler Starting Feature","ShortDescription":"Gain the Shield of Devotion power","Text":"You gain the shield of devotion power."},{"Name":"Channel Divinity","ShortDescription":"Invoke a channel divinity class feature or other power; encounter.","Text":"Once per encounter you can invoke divine power, filling yourself with the might of your patron deity. With the divine might you invoke you can wield special powers. You can also learn other uses for this feature; for instance, the divinity feats grant characters with access to the Channel Divinity class feature the ability to use additional special powers.### Regardless of how many different uses for Channel Divinity you know, you can use only one such ability per encounter. The special ability or power you invoke works just like your other powers."},{"Name":"Divine Challenge","ShortDescription":"Use divine challenge as an at-will power; minor action.","Text":"The challenge of a paladin is filled with divine menace. You can use the divine challenge power to mark an enemy of your choice."},{"Name":"Lay on Hands","ShortDescription":"Use lay on hands: can be traded out for ardent vow or virtue\'s touch","Text":"Using the lay on hands power, paladins can grant their comrades additional resilience with a touch of their hands and a short prayer, though they must give of their own strength to do so."},{"Name":"Knight Hospitaler Level 5 Feature","ShortDescription":"Receive hospitality from allied temples, orders and noble houses","Text":"You can request food and lodging for yourself and your traveling companions from any temple affiliated with your hospitaler order, or from any noble household. Your request for hospitality will be honored in all but the most unusual circumstances."},{"Name":"Knight Hospitaler Level 10 Feature","ShortDescription":"Use Shield of Devotion 2/encounter","Text":"You can use shield of devotion twice per encounter."},{"Name":"Hospitaler\'s Action","ShortDescription":"When you spend an action point (extra action), allies within 5 sq. regain [Wis mod] hit points","Text":"When you spend an action point to take an extra action, each ally within 5 squares regains hit points equal to your Wisdom modifier."},{"Name":"Hospitaler\'s Blessing","ShortDescription":"When a challenged foe attacks your ally and excludes you from the attack, that ally regains hp (1/2 level + [Wis mod])","Text":"When an enemy that you currently challenge makes an attack against one of your allies that does not include you, whether the attack hits or misses, that ally regains hit points equal to one-half your level + your Wisdom modifier."}],"CombatantType":"Character","Feats":[{"Name":"Power of the Sun","ShortDescription":"+2 to Insight; enemy hit with associated power gains vulnerable 3/5/8 (by tier) radiant until EoNT","Text":"You gain a +2 feat bonus to Insight checks."},{"Name":"Devoted Paladin","ShortDescription":"Gain 1 healing surge; add Cha modifier to lay on hands healing used on ally","Text":"When you use your lay on hands on an ally, that ally regains additional hit points equal to your Charisma modifier.###Your number of healing surges increases by one."},{"Name":"Virtuous Recovery","ShortDescription":"Gain resist Wis modifier all until SoNT when you spend healing surge","Text":"Whenever you spend a healing surge, you gain resistance to all damage equal to your Wisdom modifier until the start of your next turn."},{"Name":"Lend Health","ShortDescription":"Allies you heal may use your healing surge value to determine regained hps","Text":"Whenever you use a power that allows an ally to spend a healing surge or regain hit points as if he or she had spent a healing surge, that ally can use your healing surge value to determine the number of hit points regained."},{"Name":"Swift Recovery","ShortDescription":"+3/4/5 (by tier) to healing surge value.","Text":"You gain a +3 feat bonus to your healing surge value. The bonus increases to +4 at 11th level and +5 at 21st level."},{"Name":"Superior Will","ShortDescription":"+2/3/4 (by tier) to Will. Additional saving throw vs. dazed or stunned at start of turn, even if condition is not (save ends)","Text":"You gain a +2 feat bonus to Will. This bonus increases to +3 at 11th level and +4 at 21st level.### In addition, if you are dazed or stunned, you can make a saving throw at the start of your turn to end that effect, even if the effect doesn\'t normally end on a save."},{"Name":"Devout Protector Expertise","ShortDescription":"Gain +1 feat bonus per tier to weapon attack rolls you make with any one-handed melee weapon and a +1 feat bonus per tier to holy symbol implement attacks. While you use a shield, your allies gain a +1 shield bonus to AC.","Text":"You gain a +1 feat bonus to weapon attack rolls you make with any one-handed melee weapon and a +1 feat bonus to implement attack rolls you make with holy symbols. These bonuses increase to +2 at 11th level and +3 at 21st level.###   In addition, while you use a shield, your allies gain a +1 shield bonus to AC."},{"Name":"Hero\'s Poise","ShortDescription":"When you save to end effect, allies within 5 sq. who see you gain Cha modifier bonus to saving throws until SoNT","Text":"When you succeed on a saving throw to end an effect, each ally that can see you within 5 squares of you gains a bonus to saving throws equal to your Charisma modifier until the start of your next turn."}],"Gender":"male","HealingSurges":12,"Items":[{"Name":"Longsword","ArmorCategory":"","ArmorType":"","Category":"","Count":0,"EquippedCount":0,"Flavor":"","ItemSlot":"One-hand","Text":"","Type":"Weapon","Weight":"4"},{"Name":"Gith Plate Armor","ArmorCategory":"Plate","ArmorType":"Heavy","Category":"","Count":0,"EquippedCount":0,"Flavor":"","ItemSlot":"Body","Text":"Gith plate is hardened with psionic techniques originating with either the mind flayers or the first generation of escaped githyanki slaves.","Type":"Armor","Weight":"50"},{"Name":"Devil\'s Claw +2","ArmorCategory":"","ArmorType":"","Category":"","Count":0,"EquippedCount":0,"Flavor":"This hideous, clawed hand hangs on a thick hemp cord. Holding it makes you feel as if you had the power to enthrall even the most powerful infernal beings.","ItemSlot":"Neck","Text":"","Type":"Magic Item","Weight":""},{"Name":"Plate Armor","ArmorCategory":"Plate","ArmorType":"Heavy","Category":"","Count":0,"EquippedCount":0,"Flavor":"","ItemSlot":"Body","Text":"The heaviest type of armor, made up of shaped plates of metal or similarly resilient material, plate provides the most armor protection. The cost for its superior fortification is mobility and agility.","Type":"Armor","Weight":"50"},{"Name":"Adventurer\'s Kit","ArmorCategory":"","ArmorType":"","Category":"Gear","Count":0,"EquippedCount":0,"Flavor":"","ItemSlot":"","Text":"This kit includes a backpack, a bedroll, flint and steel, a belt pouch, two sunrods, ten days\' worth of trail rations, 50 feet of hempen rope, and a waterskin.","Type":"Gear","Weight":"33"},{"Name":"Longsword","ArmorCategory":"","ArmorType":"","Category":"","Count":0,"EquippedCount":0,"Flavor":"","ItemSlot":"One-hand","Text":"","Type":"Weapon","Weight":"4"},{"Name":"Heavy Shield","ArmorCategory":"Heavy Shields","ArmorType":"Shield","Category":"","Count":0,"EquippedCount":0,"Flavor":"","ItemSlot":"Off-hand","Text":"While you\'re using a heavy shield, you can\'t use your shield hand for any other task, since you must use that hand to handle the shield.","Type":"Armor","Weight":"15"},{"Name":"Plate Armor","ArmorCategory":"Plate","ArmorType":"Heavy","Category":"","Count":1,"EquippedCount":1,"Flavor":"","ItemSlot":"Body","Text":"The heaviest type of armor, made up of shaped plates of metal or similarly resilient material, plate provides the most armor protection. The cost for its superior fortification is mobility and agility.","Type":"Armor","Weight":"50"},{"Name":"Longsword","ArmorCategory":"","ArmorType":"","Category":"","Count":1,"EquippedCount":1,"Flavor":"","ItemSlot":"One-hand","Text":"","Type":"Weapon","Weight":"4"},{"Name":"Symbol of the Champion\'s Code +2","ArmorCategory":"","ArmorType":"","Category":"","Count":1,"EquippedCount":0,"Flavor":"A code of honor is inscribed on this symbol, reinforcing your commitment to your god and making your challenge irresistible.","ItemSlot":"Off-hand","Text":"","Type":"Magic Item","Weight":""},{"Name":"Healer\'s Brooch +2","ArmorCategory":"","ArmorType":"","Category":"","Count":1,"EquippedCount":1,"Flavor":"This innocuous adornment boosts your healing powers.","ItemSlot":"Neck","Text":"","Type":"Magic Item","Weight":""},{"Name":"Iron Armbands of Power (heroic tier)","ArmorCategory":"","ArmorType":"","Category":"","Count":1,"EquippedCount":1,"Flavor":"These plate armbands enhance the damage you dole out.","ItemSlot":"Arms","Text":"","Type":"Magic Item","Weight":""},{"Name":"Gloves of the Healer (paragon tier)","ArmorCategory":"","ArmorType":"","Category":"","Count":1,"EquippedCount":1,"Flavor":"Your healing is enhanced by this elegant handwear.","ItemSlot":"Hands","Text":"","Type":"Magic Item","Weight":""},{"Name":"Heavy Shield","ArmorCategory":"Heavy Shields","ArmorType":"Shield","Category":"","Count":1,"EquippedCount":1,"Flavor":"","ItemSlot":"Off-hand","Text":"While you\'re using a heavy shield, you can\'t use your shield hand for any other task, since you must use that hand to handle the shield.","Type":"Armor","Weight":"15"},{"Name":"Superior crossbow","ArmorCategory":"","ArmorType":"","Category":"","Count":0,"EquippedCount":0,"Flavor":"","ItemSlot":"Two-Hands","Text":"This crossbow appears similar to a traditional crossbow, but it has knobs and dials that allow the weapon to be fine-tuned for greater accuracy.","Type":"Weapon","Weight":"6"},{"Name":"Glaive","ArmorCategory":"","ArmorType":"","Category":"","Count":1,"EquippedCount":0,"Flavor":"","ItemSlot":"Two-Hands","Text":"","Type":"Weapon","Weight":"10"}],"PassiveInsight":26,"PassivePerception":19,"Powers":[{"Name":"Melee Basic Attack","Display":"Basic Attack","ActionType":"Standard Action","Attack":"Strength vs. AC","AttackType":"Melee weapon","Effect":"","Flavor":"You resort to the simple attack you learned when you first picked up a melee weapon.","Hit":"1[W] + Strength modifier damage.","Keywords":["Weapon"],"PowerType":"","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"One creature","Text":"","Usage":"At-Will","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":14,"AttackStat":"Strength","Conditions":[],"Damage":"1d8+6","DamageComponents":["+1 Strength modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+1 Strength modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":8,"AttackStat":"Strength","Conditions":[],"Damage":"2d4+3","DamageComponents":["+1 Strength modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+1 Strength modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":8,"AttackStat":"Strength","Conditions":[],"Damage":"1d4+3","DamageComponents":["+1 Strength modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+1 Strength modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]},{"Name":"Ranged Basic Attack","Display":"Basic Attack","ActionType":"Standard Action","Attack":"Dexterity vs. AC","AttackType":"Ranged weapon","Effect":"","Flavor":"You resort to the simple attack you learned when you first picked up a ranged weapon.","Hit":"1[W] + Dexterity modifier damage.","Keywords":["Weapon"],"PowerType":"","Range":{"AttackType":"RangedWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"One creature","Text":"","Usage":"At-Will","Weapons":[{"Name":"Unarmed","AttackBonus":4,"AttackStat":"Dexterity","Conditions":[],"Damage":"1d4-1","DamageComponents":["-1 Dexterity modifier."],"DamageType":"","Defense":"AC","HitComponents":["-1 Dexterity modifier.","+5 half your level."]}]},{"Name":"Shield of Devotion","Display":"Knight Hospitaler Utility","ActionType":"Immediate Reaction","Attack":"","AttackType":"Close burst 5","Effect":"The target regains hit points equal to your Wisdom modifier or Charisma modifier. Until the end of your next turn, you gain a +2 power bonus to your next attack roll against the enemy that damaged the target.### Level 11: The target regains hit points equal to 5 + your Wisdom modifier or Charisma modifier.### Level 21: The target regains hit points equal to 10 + your Wisdom modifier or Charisma modifier.","Flavor":"With a quick prayer you bestow minor healing on a stricken ally, then prepare yourself to smite the enemy who struck your friend.","Hit":"","Keywords":["Divine","Healing"],"PowerType":"Utility","Range":{"AttackType":"CloseBurst","Distance":5.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"The triggering ally","Text":"","Usage":"Encounter","Weapons":[{"Name":"Unarmed","AttackBonus":5,"AttackStat":"Invalid","Conditions":[],"Damage":null,"DamageComponents":[],"DamageType":"","Defense":"Invalid","HitComponents":["+5 half your level."]}]},{"Name":"Enfeebling Strike","Display":"Paladin Attack 1","ActionType":"Standard Action","Attack":"Charisma vs. AC","AttackType":"Melee weapon","Effect":"","Flavor":"Your brutal weapon attack leaves your foe weakened.","Hit":"1[W] + Charisma modifier damage. If you marked the target, it takes a –2 penalty to attack rolls until the end of your next turn.###Increase damage to 2[W] + Charisma modifier at 21st level.","Keywords":["Divine","Weapon"],"PowerType":"Attack","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"One creature","Text":"","Usage":"At-Will","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":18,"AttackStat":"Charisma","Conditions":[],"Damage":"1d8+10","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"2d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"1d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]},{"Name":"Divine Challenge","Display":"Paladin Feature","ActionType":"Minor Action","Attack":"","AttackType":"Close burst 5","Effect":"You mark the target. The mark lasts until you use this power again. The mark also ends at the end of your turn if you didn\'t engage the target, meaning you neither attacked it during your turn nor are adjacent to it at the end of your turn. Until the mark ends, the target takes radiant damage the first time each round when it targets any of your allies with an attack power that doesn\'t include you as a target. The damage equals 3 + your Charisma modifier.###Level 11: 6 + your Charisma modifier radiant damage.###Level 21: 9 + your Charisma modifier radiant damage.","Flavor":"You boldly confront a nearby enemy, searing it with divine light if it ignores your challenge.","Hit":"","Keywords":["Divine","Radiant"],"PowerType":"Feature","Range":{"AttackType":"CloseBurst","Distance":5.0,"MaxDistance":0.0,"Size":0.0},"Source":"Player\'s Handbook","Target":"One creature in burst","Text":"","Usage":"At-Will","Weapons":[]},{"Name":"Lay on Hands","Display":"Paladin Feature","ActionType":"Minor Action","Attack":"","AttackType":"Melee touch","Effect":"You spend a healing surge but regain no hit points. Instead, the target regains hit points as if it had spent a healing surge. You must have at least one healing surge remaining to use this power.","Flavor":"Your divine touch instantly heals wounds.","Hit":"","Keywords":["Divine","Healing"],"PowerType":"Feature","Range":{"AttackType":"MeleeTouch","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"Player\'s Handbook","Target":"One creature","Text":"","Usage":"At-Will","Weapons":[{"Name":"Unarmed","AttackBonus":5,"AttackStat":"Invalid","Conditions":[],"Damage":null,"DamageComponents":[],"DamageType":"","Defense":"Invalid","HitComponents":["+5 half your level."]}]},{"Name":"Ardent Strike","Display":"Paladin Attack 1","ActionType":"Standard Action","Attack":"Strength or Charisma vs. AC","AttackType":"Melee weapon","Effect":"","Flavor":"You attack your enemy and make it the focus of your god\'s anger.","Hit":"1[W] + Strength modifier or Charisma modifier damage, and the target is subject to your divine sanction until the end of your next turn.###Level 21: 2[W] + Strength modifier or Charisma modifier damage.","Keywords":["Divine","Weapon"],"PowerType":"Attack","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"One creature","Text":"","Usage":"At-Will","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":18,"AttackStat":"Charisma","Conditions":[],"Damage":"1d8+10","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"2d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"1d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]},{"Name":"Virtuous Strike","Display":"Paladin Attack 1","ActionType":"Standard Action","Attack":"Charisma vs. AC","AttackType":"Melee weapon","Effect":"","Flavor":"The clean light of your weapon pierces your enemies and fills you with resolve.","Hit":"1[W] + Charisma modifier radiant damage, and you gain a +2 bonus to saving throws until the start of your next turn.###Level 21: 2[W] + Charisma modifier radiant damage.","Keywords":["Divine","Radiant","Weapon"],"PowerType":"Attack","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"One creature","Text":"","Usage":"At-Will","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":18,"AttackStat":"Charisma","Conditions":[],"Damage":"1d8+10","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"Radiant","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"2d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"Radiant","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"1d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"Radiant","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]},{"Name":"Valorous Smite","Display":"Paladin Attack 1","ActionType":"Standard action","Attack":"Charisma vs. AC","AttackType":"Melee weapon","Effect":"","Flavor":"You cry out as you strike, daring all your enemies to face you.","Hit":"2[W] + Charisma modifier damage. Each enemy within 3 squares of you is subject to your divine sanction until the end of your next turn.","Keywords":["Divine","Weapon"],"PowerType":"Attack","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"Divine Power","Target":"One creature","Text":"","Usage":"Encounter","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":18,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+10","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"4d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"2d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]},{"Name":"Majestic Halo","Display":"Paladin Attack 1","ActionType":"Standard action","Attack":"Charisma vs. AC","AttackType":"Melee weapon","Effect":"Until the end of the encounter, any enemy that starts its turn adjacent to you is subject to your divine sanction until the end of its turn.","Flavor":"You shine with divine radiance that sears your enemies as you attack and commands their respect.","Hit":"3[W] + Charisma modifier radiant damage.","Keywords":["Divine","Radiant","Weapon"],"PowerType":"Attack","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"Divine Power","Target":"One creature","Text":"","Usage":"Daily","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":18,"AttackStat":"Charisma","Conditions":[],"Damage":"3d8+10","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"Radiant","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"6d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"Radiant","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"3d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"Radiant","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]},{"Name":"Divine Mettle","Display":"Paladin Feature","ActionType":"Minor Action","Attack":"","AttackType":"Close burst 10","Effect":"The target makes a saving throw with a bonus equal to your Charisma modifier.","Flavor":"Your unswerving faith in your deity empowers a nearby creature to resist a debilitating affliction.","Hit":"","Keywords":["Divine"],"PowerType":"Feature","Range":{"AttackType":"CloseBurst","Distance":10.0,"MaxDistance":0.0,"Size":0.0},"Source":"Player\'s Handbook","Target":"One creature in burst","Text":"","Usage":"Encounter","Weapons":[]},{"Name":"Divine Strength","Display":"Paladin Feature","ActionType":"Minor Action","Attack":"","AttackType":"Personal","Effect":"Apply your Strength modifier as extra damage on your next attack this turn.","Flavor":"You petition your deity for the divine strength to lay low your enemies.","Hit":"","Keywords":["Divine"],"PowerType":"Feature","Range":{"AttackType":"Personal","Distance":0.0,"MaxDistance":0.0,"Size":0.0},"Source":"Player\'s Handbook","Target":"","Text":"","Usage":"Encounter","Weapons":[]},{"Name":"Bless Weapon","Display":"Paladin Utility 2","ActionType":"Minor Action","Attack":"","AttackType":"Personal","Effect":"Choose one weapon you are wielding. Until the end of the encounter, you gain a +1 power bonus to attack rolls with that weapon, and it deals 1d6 extra radiant damage on a hit. In addition, you can score a critical hit with the weapon on a roll of 18–20 against creatures vulnerable to radiant damage.","Flavor":"You recite an ancient prayer to imbue your weapon with the power of pure faith.","Hit":"","Keywords":["Divine","Radiant"],"PowerType":"Utility","Range":{"AttackType":"Personal","Distance":0.0,"MaxDistance":0.0,"Size":0.0},"Source":"Divine Power","Target":"","Text":"","Usage":"Daily","Weapons":[]},{"Name":"Righteous Smite","Display":"Paladin Attack 3","ActionType":"Standard action","Attack":"Charisma vs. AC","AttackType":"Melee weapon","Effect":"","Flavor":"Your righteous blow fills you and your nearby allies with preternatural resolve.","Hit":"2[W] + Charisma modifier damage, and you and each ally within 5 squares of you gain temporary hit points equal to 5 + your Wisdom modifier.","Keywords":["Divine","Weapon"],"PowerType":"Attack","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"Player\'s Handbook","Target":"One creature","Text":"","Usage":"Encounter","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":18,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+10","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"4d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"2d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]},{"Name":"Name of Might","Display":"Paladin Attack 5","ActionType":"Standard action","Attack":"Charisma vs. Fortitude","AttackType":"Close blast 3","Effect":"","Flavor":"You shout an ancient angelic name of thunderous power that slows your foes.","Hit":"3d8 + Charisma modifier thunder damage, and the target is slowed (save ends).","Keywords":["Divine","Implement","Thunder"],"PowerType":"Attack","Range":{"AttackType":"CloseBlast","Distance":3.0,"MaxDistance":0.0,"Size":0.0},"Source":"Divine Power","Target":"Each enemy in blast","Text":"","Usage":"Daily","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":15,"AttackStat":"Charisma","Conditions":[],"Damage":"3d8+8","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus."],"DamageType":"Thunder","Defense":"Fortitude","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Symbol of the Champion\'s Code +2","AttackBonus":14,"AttackStat":"Charisma","Conditions":[],"Damage":"3d8+7","DamageComponents":["+5 Charisma modifier.","+2 enhancement bonus."],"DamageType":"Thunder","Defense":"Fortitude","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Unarmed","AttackBonus":10,"AttackStat":"Charisma","Conditions":[],"Damage":"3d8+5","DamageComponents":["+5 Charisma modifier."],"DamageType":"Thunder","Defense":"Fortitude","HitComponents":["+5 Charisma modifier.","+5 half your level."]}]},{"Name":"Deliverance of Faith","Display":"Religion Utility 6","ActionType":"Minor Action","Attack":"","AttackType":"Personal","Effect":"You spend a healing surge but regain no hit points. You gain temporary hit points equal to your healing surge value.","Flavor":"You give of yourself in the belief that somewhere, something will give a little back.","Hit":"","Keywords":[],"PowerType":"Utility","Range":{"AttackType":"Personal","Distance":0.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"","Text":"","Usage":"Encounter","Weapons":[]},{"Name":"Astral Thunder","Display":"Paladin Attack 7","ActionType":"Standard action","Attack":"Charisma vs. Fortitude","AttackType":"Close burst 3","Effect":"","Flavor":"The power of your god\'s dominion thunders through your holy symbol to pummel nearby foes.","Hit":"2d8 + Charisma modifier thunder damage. Until the end of your next turn, the target takes a penalty to attack rolls equal to your Wisdom modifier.","Keywords":["Divine","Implement","Thunder"],"PowerType":"Attack","Range":{"AttackType":"CloseBurst","Distance":3.0,"MaxDistance":0.0,"Size":0.0},"Source":"Divine Power","Target":"Each enemy in burst","Text":"","Usage":"Encounter","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":15,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+8","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus."],"DamageType":"Thunder","Defense":"Fortitude","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Symbol of the Champion\'s Code +2","AttackBonus":14,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+7","DamageComponents":["+5 Charisma modifier.","+2 enhancement bonus."],"DamageType":"Thunder","Defense":"Fortitude","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Unarmed","AttackBonus":10,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+5","DamageComponents":["+5 Charisma modifier."],"DamageType":"Thunder","Defense":"Fortitude","HitComponents":["+5 Charisma modifier.","+5 half your level."]}]},{"Name":"Crown of Glory","Display":"Paladin Attack 9","ActionType":"Standard action","Attack":"Charisma vs. Will","AttackType":"Close burst 1","Effect":"Any enemy that starts its turn adjacent to you is slowed until the end of your next turn.","Flavor":"A scintillating crown of radiant energy appears above your head, then expands suddenly to cripple nearby enemies.","Hit":"2d8 + Charisma modifier radiant damage.","Keywords":["Divine","Implement","Radiant"],"PowerType":"Attack","Range":{"AttackType":"CloseBurst","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"Player\'s Handbook","Target":"Each enemy in burst","Text":"","Usage":"Daily","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":15,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+8","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus."],"DamageType":"Radiant","Defense":"Will","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Symbol of the Champion\'s Code +2","AttackBonus":14,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+7","DamageComponents":["+5 Charisma modifier.","+2 enhancement bonus."],"DamageType":"Radiant","Defense":"Will","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Unarmed","AttackBonus":10,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+5","DamageComponents":["+5 Charisma modifier."],"DamageType":"Radiant","Defense":"Will","HitComponents":["+5 Charisma modifier.","+5 half your level."]}]},{"Name":"Fight on, Friend","Display":"Knight Hospitaler Utility 10","ActionType":"Minor Action","Attack":"","AttackType":"Melee touch","Effect":"The target regains hit points equal to twice his or her healing surge value. In addition, the target automatically saves against one effect that a save can end.","Flavor":"You heal a badly wounded companion, restoring health and banishing one affliction or hindering condition of your choice.","Hit":"","Keywords":["Divine","Healing"],"PowerType":"Utility","Range":{"AttackType":"MeleeTouch","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"","Target":"One bloodied or unconscious ally","Text":"As a devoted hospitaler, you seek to keep your allies on their feet, battling on valiantly against whatever evils confront you. This powerful prayer restores a badly wounded ally to something approaching full health, and cures him or her of one detrimental condition.","Usage":"Daily","Weapons":[{"Name":"Unarmed","AttackBonus":5,"AttackStat":"Invalid","Conditions":[],"Damage":null,"DamageComponents":[],"DamageType":"","Defense":"Invalid","HitComponents":["+5 half your level."]}]},{"Name":"Warding Blow","Display":"Hospitaler Attack 11","ActionType":"Standard action","Attack":"Charisma vs. AC","AttackType":"Melee weapon","Effect":"","Flavor":"You strike a foe you have challenged, bringing hope and encouragement to nearby allies.","Hit":"2[W] + Charisma modifier damage, and each ally within 5 squares of you can make a saving throw.","Keywords":["Divine","Weapon"],"PowerType":"Attack","Range":{"AttackType":"MeleeWeapon","Distance":1.0,"MaxDistance":0.0,"Size":0.0},"Source":"Player\'s Handbook","Target":"One creature that is marked by you","Text":"","Usage":"Encounter","Weapons":[{"Name":"Bradaman\'s Longsword +3","AttackBonus":18,"AttackStat":"Charisma","Conditions":[],"Damage":"2d8+10","DamageComponents":["+5 Charisma modifier.","+3 enhancement bonus.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+3 proficiency bonus.","+3 enhancement bonus.","+2 Feat bonus - Devout Protector Expertise"]},{"Name":"Glaive","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"4d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 proficiency bonus."]},{"Name":"Unarmed","AttackBonus":12,"AttackStat":"Charisma","Conditions":[],"Damage":"2d4+7","DamageComponents":["+5 Charisma modifier.","+2 item bonus - Iron Armbands of Power (heroic tier)"],"DamageType":"","Defense":"AC","HitComponents":["+5 Charisma modifier.","+5 half your level.","+2 Feat bonus - Devout Protector Expertise"]}]}],"PowerSource":"Divine","RacialTraits":[{"Name":"Bonus Feat","ShortDescription":"Choose an extra feat at 1st level.","Text":"You gain a bonus feat at 1st level. You must meet the feat\'s prerequisites."},{"Name":"Bonus Skill","ShortDescription":"Trained in one additional class skill.","Text":"You gain training in one additional skill from your class skills list."},{"Name":"Human Defense Bonuses","ShortDescription":"+1 to Fortitude, Reflex, and Will.","Text":"You gain a +1 racial bonus to Fortitude, Reflex, and Will."},{"Name":"Human Power Selection","ShortDescription":"Choose an option for your human character.","Text":"Choose an option for your human character."},{"Name":"Bonus At-Will Power","ShortDescription":"Know one extra 1st-level attack power from your class.","Text":"You know one extra 1st level at-will attack power from your class."}],"Skills":{"Acrobatics":{"IsTrained":false,"Value":0},"Arcana":{"IsTrained":false,"Value":5},"Athletics":{"IsTrained":false,"Value":4},"Bluff":{"IsTrained":false,"Value":10},"Diplomacy":{"IsTrained":true,"Value":15},"Dungeoneering":{"IsTrained":false,"Value":9},"Endurance":{"IsTrained":true,"Value":7},"Heal":{"IsTrained":true,"Value":14},"History":{"IsTrained":false,"Value":5},"Insight":{"IsTrained":true,"Value":16},"Intimidate":{"IsTrained":false,"Value":10},"Nature":{"IsTrained":false,"Value":9},"Perception":{"IsTrained":false,"Value":9},"Religion":{"IsTrained":true,"Value":10},"Stealth":{"IsTrained":false,"Value":0},"Streetwise":{"IsTrained":false,"Value":10},"Thievery":{"IsTrained":false,"Value":0}},"Vision":"Normal","AbilityScores":{"Strength":13,"Constitution":13,"Dexterity":9,"Intelligence":11,"Wisdom":19,"Charisma":21},"ActionPoints":1,"Alignment":"LawfulGood","Defenses":{"AC":28,"Fortitude":20,"Reflex":21,"Will":27},"Experience":26000,"Handle":"* Duncan McTiernan (Paladin11)","HitPoints":88,"Initiative":4,"Speed":5,"Languages":["Common","Draconic"],"Level":11,"Name":"Duncan McTiernan","Race":"Human","Role":"Defender","Size":"Medium"}';

function ViewModel() {
    var self = this;

    this.Bound = false;

    this.Character = ko.observable();

    this.Alignment = function () {
        return StatblockHelpers.splitOnCaps(self.Character().Alignment);
    };
    this.Bloodied = function () {
        return (self.Character().HitPoints / 2).toFixed(0);
    };
    this.LevelString = function () {
        var parts = [];

        parts.push('Level');
        parts.push(self.Character().Level);
        parts.push(self.Character().PowerSource);
        parts.push(self.Character().Role);
        return parts.join(' ');
    };
    this.TraitsString = function () {
        var parts = [];

        parts.push(self.Character().Gender);
        parts.push(self.Character().Race);
        parts.push(self.Character().Class);
        return parts.join(' ');
    };
    this.XPString = function () {
        return 'XP ' + StatblockHelpers.toCommaNum(self.Character().Experience);
    };
}

// transform the ViewModel so that we can map our data to
// it each time renderStatBlock is called
window.vm = new ViewModel();
ko.bindingProvider.instance = new StringInterpolatingBindingProvider();

// externally invoked method to render a new StatBlock
function renderStatBlock(json) {
    try {
        var data = ko.utils.parseJson(json);
        window.vm.Character(data);
        if (!vm.Bound) {
            vm.Bound = true;
            ko.applyBindings(window.vm);
        }
    }
    catch (e) {
        alert(e.toString());
    }
}

//$(document).ready(function () {
//   renderStatBlock(debugJson);
//});
